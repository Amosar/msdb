
<div *ngIf="eventEdition">
	<div class="row">
		<div class="col-lg-10 col-md-10">
    		<h2>{{eventEdition.longEventName}}</h2>
    	</div>
    	<div class="col-lg-2 col-md-2">
    		<h2>
    			<div class="row">
   				<a class="deco-none" *ngIf="eventEdition.previousEditionId" [routerLink]="['/event-edition', eventEdition.previousEditionId]"><i  class="fa fa-fw fa-angle-double-left" aria-hidden="true"></i></a>
   				<div class="col-xs-2">
   				<select class="form-control" id="field_jumpToEdition" name="jumpToEdition" (change)="jumpToEdition($event.target.value)">
   					<option></option>
	            	<option *ngFor="let edition of editions" [value]="edition.id">{{edition.editionYear}}</option>
	            </select>
	            </div>
   				<a class="deco-none" *ngIf="eventEdition.nextEditionId" [routerLink]="['/event-edition', eventEdition.nextEditionId]"><i  class="fa fa-fw fa-angle-double-right" aria-hidden="true"></i></a>
   				</div>
    		</h2>
    	</div>
    </div>
    <hr>
    <jhi-alert-error></jhi-alert-error>
    <ngb-tabset>
	  <ngb-tab title="{{'motorsportsDatabaseApp.eventEdition.info' | translate}}">
	    <template ngbTabContent>
		    <div class="row">
				<div class="col-lg-4 col-md-4">
				    <dl class="row-md jh-entity-details">
				        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.editionYear">Edition Year</span></dt>
				        <dd>
				            <span>{{eventEdition.editionYear}}</span>
				        </dd>
				        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.shortEventName">Short Event Name</span></dt>
				        <dd>
				            <span>{{eventEdition.shortEventName}}</span>
				        </dd>
				        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.eventDate">Event Date</span></dt>
				        <dd>
				            <span>{{eventEdition.eventDate | date:'mediumDate'}}</span>
				        </dd>
				        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.trackLayout">Track Layout</span></dt>
				        <dd>
				            <div *ngIf="eventEdition.trackLayout">
				                <a [routerLink]="['/racetrack', eventEdition.trackLayout.racetrack.id, 'racetrack-layout', eventEdition.trackLayout?.id ]" >
				                	{{eventEdition.trackLayout?.racetrack.name}} - {{eventEdition.trackLayout?.name}}
								</a>
								<div *ngIf="eventEdition.trackLayout.layoutImageUrl">
					            	<img [src]="eventEdition.trackLayout.layoutImageUrl" style="max-width: 300px;" alt="layout image"/>
					            </div>
				            </div>
				        </dd>
				        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.event">Event</span></dt>
				        <dd>
				            <div *ngIf="eventEdition.event">
				                <a [routerLink]="['/event', eventEdition.event?.id]">{{eventEdition.event?.name}}</a>
				            </div>
				        </dd>
				    </dl>
				</div>
				<div class="col-lg-8 col-md-8">
					<dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.allowedCategories">Allowed Categories</span></dt>
					<dd>
			            <ul class="list-unstyled">
			                <li *ngFor="let category of eventEdition.allowedCategories">
			                    <span>{{category.name}} ({{category.shortname}})</span>
			                </li>
			            </ul>
			        </dd>
			        <dt><span jhiTranslate="motorsportsDatabaseApp.eventEdition.sessions">Sessions</span></dt>
					<dd>
			            <div class="table-responsive" *ngIf="eventEdition.sessions">
					        <table class="table table-striped">
					            <thead>
					            <tr>
					            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.session.sessionStartTime">Session Start Time</span></th>
					            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.session.shortname">Shortname</span></th>
					            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.session.duration">Duration</span></th>
					            <th></th>
					            </tr>
					            </thead>
					            <tbody>
					            <tr *ngFor="let eventSession of eventEdition.sessions ;trackBy: trackId">
					                <td>{{eventSession.sessionStartTime | date:'medium'}}</td>
					                <td>{{eventSession.shortname}}</td>
					                <td>{{eventSession.duration}} {{'motorsportsDatabaseApp.eventEdition.enumerations.' + durationTypes[eventSession.durationType] | translate}} 
					                	<span *ngIf="eventSession.additionalLap">+ 1 {{'motorsportsDatabaseApp.eventEdition.session.lap' | translate}}</span>
					                </td>
					                <td class="text-right">
					                    <div class="btn-group flex-btn-group-container">
					                        <button type="submit" *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
					                                [routerLink]="['/', { outlets: { popup: eventEdition.id + '/event-session/'+ eventSession.id + '/edit'} }]"
					                                replaceUrl="true"
					                                class="btn btn-primary btn-sm">
					                            <span class="fa fa-pencil"></span>
					                        </button>
					                        <button type="submit" *jhiHasAnyAuthority="['ROLE_ADMIN']"
					                                [routerLink]="['/', { outlets: { popup: eventEdition.id + '/event-session/'+ eventSession.id + '/delete'} }]"
					                                replaceUrl="true"
					                                class="btn btn-danger btn-sm">
					                            <span class="fa fa-remove"></span>
					                        </button>
					                    </div>
					                </td>
					            </tr>
					            </tbody>
					        </table>
					    </div>			            
				        <button *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
				        	class="btn btn-primary float-right create-event-session" [routerLink]="['/', { outlets: { popup: eventEdition.id + '/event-session-new' } }]">
				            <span class="fa fa-plus"></span>
				        </button>
				        <button type="button" *ngIf="!convertedTime && eventEdition.sessions"
				        	class="btn btn-primary float-right create-event-session" (click)="convertToCurrentTZ()">
				            To converted
				        </button>
				        <button type="button" *ngIf="convertedTime && eventEdition.sessions"
				        	class="btn btn-primary float-right create-event-session" (click)="convertToLocalTZ()">
				            To local
				        </button>
			        </dd>
				</div>
			</div>
		    <button type="button"
		            [routerLink]="['/', { outlets: { popup: 'event-edition/'+ eventEdition.id + '/edit'} }]"
		            replaceUrl="true"
		            class="btn btn-primary">
		        <span class="fa fa-pencil"></span>&nbsp;<span jhiTranslate="entity.action.edit"> Edit</span>
		    </button>
		</template>
	</ngb-tab>
	<ngb-tab title="{{'motorsportsDatabaseApp.eventEdition.entryList' | translate}}">
	    <template ngbTabContent>
	    	<div class="row" *ngIf="eventEntries.length > 0">
		        <div class="col-sm-12 no-padding-right">
	                <div class="input-group w-100 mt-3">
	                    <ul *ngIf="eventEntries" class="list-unstyled">
	                    	<li *ngIf="eventEdition.allowedCategories.length === 1">
			                    <strong><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.category"></span>:</strong> {{eventEdition.allowedCategories[0].name}}
			                </li>
			                <li *ngIf="eventEdition.singleChassis">
			                    <strong><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.chassis"></span>:</strong> {{eventEntries[0].chassis.manufacturer}} {{eventEntries[0].chassis.name}}
			                </li>
			                <li *ngIf="eventEdition.singleEngine">
			                    <strong><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.engine"></span>:</strong> {{eventEntries[0].engine.manufacturer}} {{eventEntries[0].engine.name}}
			                </li>
			                <li *ngIf="eventEdition.singleTyre">
			                    <strong><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.tyres"></span>:</strong> {{eventEntries[0].tyres.name}}
			                </li>
			                <li *ngIf="eventEdition.singleFuel">
			                    <strong><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.fuel"></span>:</strong> {{eventEntries[0].fuel.name}}
			                </li>
			            </ul>	                    
	                </div>
		        </div>
		    </div>
	    	<div class="table-responsive" *ngIf="eventEntries">
    			<div class="float-right" *ngIf="eventEdition.allowedCategories.length > 1">
	    			<select class="form-control" id="field_category" name="category" [(ngModel)]="filterCategory">
	    				<option value="ALL"></option>
		               	<option *ngFor="let category of eventEdition.allowedCategories" [ngValue]="category.shortname">{{category.name}}</option>
		           	</select>
	            </div>
		        <table class="table table-striped">
		            <thead>
		            <tr>
		            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.raceNumber">Number</span></th>
		            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.driver">Driver</span></th>
		            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.teamName">Team Name</span></th>
		            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.team">Team</span></th>
		            <th><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.operatedBy">Operated By</span></th>
		            <th *ngIf="!eventEdition.singleChassis"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.chassis">Chassis</span></th>
		            <th *ngIf="!eventEdition.singleEngine"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.engine">Engine</span></th>
		            <th *ngIf="eventEdition.allowedCategories.length != 1"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.category">Category</span></th>
		            <th *ngIf="!eventEdition.singleTyre"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.tyres">Tyres</span></th>
		            <th *ngIf="!eventEdition.singleFuel"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.fuel">Fuel</span></th>
		            <th></th>
		            </tr>
		            </thead>
		            <tbody>
		            <tr *ngFor="let eventEntry of eventEntries | eventEntryCategoryFilter: filterCategory ;trackBy: trackId">
		            	<td>{{eventEntry.raceNumber}}</td>
		            	<td>
		                    <div *ngIf="!eventEntry.eventEdition.multidriver">
		                        <a [routerLink]="['/driver', eventEntry.drivers[0].id ]" >{{eventEntry.drivers[0].fullName}}</a>
		                        <span *ngIf="eventEntry.rookie"> (R)</span>
		                    </div>
		                    <div *ngIf="eventEntry.eventEdition.multidriver">
		                    	<div *ngFor="let driver of eventEntry.drivers">
			                        <span class="tag">{{ driver.fullName }}</span>
			                    </div>
		                    </div>
		                </td>
		                <td>{{eventEntry.entryName}}</td>
		                <td>
		                    <div *ngIf="eventEntry.team">
		                        <a [routerLink]="['/team', eventEntry.team?.id ]" >{{eventEntry.team?.name}}</a>
		                    </div>
		                </td>
		                <td>
		                    <div *ngIf="eventEntry.operatedBy">
		                        <a [routerLink]="['/team', eventEntry.operatedBy?.id ]" >{{eventEntry.operatedBy?.name}}</a>
		                    </div>
		                </td>
		                <td *ngIf="!eventEdition.singleChassis">
		                    <div *ngIf="eventEntry.chassis">
		                        <a [routerLink]="['/chassis', eventEntry.chassis?.id ]" >{{eventEntry.chassis?.manufacturer}} {{eventEntry.chassis?.name}}</a>
		                    </div>
		                </td>
		                <td *ngIf="!eventEdition.singleEngine">
		                    <div *ngIf="eventEntry.engine">
		                        <a [routerLink]="['/engine', eventEntry.engine?.id ]" >{{eventEntry.engine?.manufacturer}} {{eventEntry.engine?.name}}</a>
		                    </div>
		                </td>
		                <td *ngIf="eventEdition.allowedCategories.length != 1">
		                    <div *ngIf="eventEntry.engine">
		                        <a [routerLink]="['/category', eventEntry.category?.id ]" >{{eventEntry.category.shortname}}</a>
		                    </div>
		                </td>
		                <td *ngIf="!eventEdition.singleTyre">
		                    <div *ngIf="eventEntry.tyres">
		                        <a [routerLink]="['/tyre-provider', eventEntry.tyres?.id ]" >{{eventEntry.tyres?.name}}</a>
		                    </div>
		                </td>
		                <td *ngIf="!eventEdition.singleFuel">
		                    <div *ngIf="eventEntry.fuel">
		                        <a [routerLink]="['/fuel-provider', eventEntry.fuel?.id ]" >{{eventEntry.fuel?.name}}</a>
		                    </div>
		                </td>
		                
		                <td class="text-right">
		                    <div class="btn-group flex-btn-group-container">
		                        <button type="submit" *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
		                                [routerLink]="['/', { outlets: { popup: 'event-entry/'+ eventEntry.id + '/edit'} }]"
		                                replaceUrl="true"
		                                class="btn btn-primary btn-sm">
		                            <span class="fa fa-pencil"></span>
		                        </button>
		                        <button type="submit" *jhiHasAnyAuthority="['ROLE_ADMIN']"
		                                [routerLink]="['/', { outlets: { popup: 'event-entry/'+ eventEntry.id + '/delete'} }]"
		                                replaceUrl="true"
		                                class="btn btn-danger btn-sm">
		                            <span class="fa fa-remove"></span>
		                        </button>
		                    </div>
		                </td>
		            </tr>
		            </tbody>
		        </table>
		        <button *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
	            	class="btn btn-success float-right" [routerLink]="['/', { outlets: { popup: eventEdition.id + '/copy-entries' } }]">
		            <span class="fa fa-plus"></span>
		            <span class="hidden-sm-down"  jhiTranslate="motorsportsDatabaseApp.eventEdition.copyEntries.copyLabel">
		            Create new Event Entry
		            </span>
		        </button>
		        <button *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
	            	class="btn btn-primary float-right create-event-entry" [routerLink]="['/', { outlets: { popup: eventEdition.id + '/event-entry-new' } }]">
		            <span class="fa fa-plus"></span>
		            <span class="hidden-sm-down"  jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.addLabel">
		            Create new Event Entry
		            </span>
		        </button>
		    </div>
	    </template>
	</ngb-tab>
	<ngb-tab title="{{'motorsportsDatabaseApp.eventEdition.results' | translate}}">
	    <template ngbTabContent>
	    	<ngb-tabset>
			  <ngb-tab *ngFor="let eventSession of eventEdition.sessions" title="{{eventSession.name}}">
			    <template ngbTabContent>
			    	<jhi-event-entry-result [session]="eventSession">Result...</jhi-event-entry-result>
			    </template>
			  </ngb-tab>
			</ngb-tabset>
	    </template>
	</ngb-tab>
	</ngb-tabset>
	<button type="submit"
            (click)="previousState()"
            class="btn btn-info">
        <span class="fa fa-arrow-left"></span>&nbsp;<span jhiTranslate="entity.action.back"> Back</span>
    </button>
</div>
